# 01-软件架构权衡-无意识决策的问题

## 0 前言

错误的技术决策常常会回过头来困扰我们，原因并不在于决策本身是错误的，而是因为做出该决策的人并未充分理解其全部影响，或更常见的，决策者甚至不知道自己在做决策。这是一种无意识的决策。换句话说，问题核心在于缺乏意识或缺乏决策的谨慎。稍后详细讨论这问题。

先澄清“技术决策”含义。这些决策涉及编码/实现、软件设计、架构、供应商选择和与第三方集成，还有非技术性的决策——即产品和业务决策，同样重要。本文以及整个架构权衡系列重点关注技术方面及其与业务的交集。

先统一术语：

- **MVP（最小可行产品）**
- POC（概念验证）
- Monolith（单体架构）：独立应用程序，执行全部或大部分功能
- Serverless（无服务器）：应用程序运行时和部署主要由云管理
- Microservices（微服务）：细粒度、解耦、独立部署的应用程序，每个应用程序负责特定功能

虽然本文主要提到初创企业，但大多数内容适用于任何技术团队或组织。

## 1 这是什么？

如何增强对技术决策的信心是一个很少被讨论但绝对关键的话题，它对建立一个能够随着组织扩展和增长而提供服务的健康技术和架构战略至关重要。

看典型初创企业的生命周期，这个企业经受住市场挑战，并踏上增长道路。有许多流行的模型描述了这一生命周期的不同阶段，每个模型都有其独特的视角。

下面的心理模型帮助直观理解这种生命周期，重点是决策通常在哪些阶段做出。初创企业的生命周期：

![](https://my-img.javaedge.com.cn/javaedge-blog/2024/06/e9bd8d6aa04db8e596967e724fb1b3f7.png)

上述显示，我们在MVP阶段开始做出大部分长期的技术决策。

注意，这是**开始**做出这类决策的阶段。决策过程永远不会停止。MVP阶段（及之后）的决策与POC阶段（及之前）的决策的区别在于：POC阶段的决策通常是临时的。它们只是为尽快推出某种产品的初步雏形。通常，这些产品甚至不是完全功能性的，而更多是展示最终结果的视觉表示。

MVP阶段的技术决策必须开始关注。这就是**技术决策意识**发挥作用的地方。该阶段的技术决策通常产生长期影响，因为这些决策将成为后续决策的基础，并将影响组织发展方向（至少在技术方面）。

## 2 错误的决策总是问题的根源吗？

记住，我在开头提到的问题不一定是决策本身的问题，而是缺乏意识和决策的谨慎吗？尽管这可能看起来违反直觉，但错误决策常常可以最小业务影响来解决。若能及时、流畅识别并解决问题，并有一个明确流程来调整决策，其影响不会像原本那么剧烈。

这只有在决策是以有意识的方式做出，并意识到决策正在被做出及其方式时才会发生。

## 3 示例

假设一个初创企业处早期MVP阶段。团队正开发SaaS，该产品聚合某种数据并将其暴露给外部。

因此，团队须决定如何部署SaaS。基础设施咋样的？应用程序咋构建？有许多方式构建应用程序和部署产品，选择很多。

团队面临选择（假设使用AWS作为云提供商）：

### 3.1 单体架构

将服务结构化为单体应用程序。将所有功能都放在一起。部署在托管的容器编排服务中：

- 一个数据库
- 一个应用程序

![](https://my-img.javaedge.com.cn/javaedge-blog/2024/06/80a1f1f7c4cabf863f97f9b7dc0a32b1.png)

### 3.2 微服务

从一开始就将服务设计为由微服务组成。有多个服务和多个数据库。所有内容都部署在容器编排服务中。

![](/Users/javaedge/Downloads/IDEAProjects/java-edge-master/assets/%E5%BE%AE%E6%9C%8D%E5%8A%A1.png)

### 3.3 无服务器/函数即服务

目前非常流行的方法。可用AWS Lambda运行应用程序，使用DynamoDB作为数据库。AWS负责运行所有这些的重任。

![](/Users/javaedge/Downloads/IDEAProjects/java-edge-master/assets/AWS%20Lambda.png)

## 4 指导方针

团队应选哪种方案？选择的影响是啥？影响多大？应投入多少精力分析每种选择？这些都是隐藏在行间的问题。此外，在每个选择中还有更多细节选择！

现在正是关键时刻，团队需做出一个**有意识的**和**有理由的**选择。注意，**这不一定是正确选择**，因为可能有多个正确选择，并且“正确”可能随未来更多背景的变化而改变。

通常，团队会隐含、无意识或在不了解影响的情况下做出决定。

那团队该咋做？他们咋确保他们的选择能最好服务于组织？幸好我们站在牛顿肩膀上，请遵循如下指导方针：

### 4.1 保持记录

若你从本文中只学到一件事，那必须是这点。看起来这应该是最容易做到的事情，但我见过的团队，很少能认真记录其技术决策。

我理解，文档很枯燥无趣，尤其当你专注于构建下一个大项目时。然而，它只需要很少时间，而清晰记录技术决策的巨大好处显而易见，它将不断地为你带来十倍、百倍、千倍回报。

每当面临技术决策并做任何重要选择时，记录何时及为何做出该选择。不需要是一份庞大的文件或复杂东西。

以下内容即可：

✅ 做出决定的时间

✅ 选择有哪些

✅ 每种选择的优缺点

✅ 为何选择特定选项

✅ 潜在担忧

在一个成熟团队/组织中，你可能需要使用更正式东西，如ADR（架构决策记录）。然而，对MVP级项目，上述内容足够。

这样的记录将允许你回顾并理解为何做出这些决策，并在以后防止混淆。它还将帮助你及早发现这些决策的任何陷阱。这引出下一要点：

### 4.2 定期重新审视你的决策

做出“正确”选择往往不如做出“有意识”选择重要，因为今天的“正确”选择可能是明年的“错误”选择。定期重审技术决策，重新评估，与团队一起头脑风暴，你将始终掌握组织技术状态的脉搏。

让这些成为定期的节奏。每月进行一两次会议。或每两个月一次会议。或每季度一次全天会议。无论哪种方式，重要的你要持续进行这些会议，并承诺将其作为定期的脉搏检查，以识别哪些技术解决方案仍然有效，哪些无效。

其实还有很多...

### 4.3 始终提出问题（尤其是当出现问题时）

质疑你的技术选择。根据公司目标进行预测，并查看这些目标如何与当前的技术状态对齐。是否能改进？咋改进？

在这里最有帮助的是对产品遇到的技术问题有敏锐意识。是否存在可扩展性问题？生产的错误率高吗？

用户等待20s才能加载网站？基础设施每周一、周四都崩溃？

这些问题是最好的指示，表明要做出改变了，并且需要重新审视和/或做出一些技术决策。

关注这些问题，记录它们，并询问咋解决它们（希望也能记录下你的发现）是开始这一过程的好方法。

## 5 结论

最终，你无法保证今天做出的决策或技术选择能永远为组织服务。在技术和业务需求不断变化的环境中，组织转向、市场趋势和其他因素的影响下，很难准确预测这些选择将如何塑造组织的未来技术状态。

然而，制定一个清晰、直观和简化的决策过程，可以优化这些决策，并在环境变化时提供调整和改变的途径。

这个过程将确保我们所做的架构权衡在我们所处的时间和条件下是正确的。