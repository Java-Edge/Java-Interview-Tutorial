# 隐私计算技术原理

## 0 隐私计算核心原理概述

隐私计算目标是让各方在**数据“可用不可见”**的前提下进行联合计算。常见技术包括：

## 1 联合建模

Joint Modeling。

### 1.1 定义

多个参与方共同训练一个机器学习模型，但各自的数据不离开本地。在满足各参与方的合规政策和数据价值保护的需求下，实现模型迭代和更新的服务。

### 1.2 类比理解

就像几个医生一起研究某种疾病的治疗方案，但每位医生只分享“经验总结”（如模型参数），而不透露具体的病人信息。

### 1.3 实际应用

- 多家保险公司想共同训练一个新能源汽车保险风险评估模型，但每家都只能用自己的客户数据
- 让大家共享模型能力，而不把原始数据给别人

### 1.4 技术实现

联邦学习或多方安全计算。

## 2 可信执行环境

Trusted Execution Environment，TEE。

### 2.1 定义

利用硬件级隔离技术（如Intel SGX、ARM TrustZone），在一个“沙盒”中执行敏感代码，外界无法窥探其中的数据。

### 1.2 类比理解

就像在金库处理现金，只有特定人员能进去操作，外面的人看不见也摸不到。

### 1.3 实际应用

- 在 TEE 中运行保险公司的评分算法，即使平台管理员也无法看到内部逻辑和数据
- 适合对性能要求高、但又必须保证安全的场景

### 1.4 技术实现

依赖 CPU 的安全扩展指令集，如Intel SGX。

利用硬件隔离确保计算过程安全可证明。在TEE中，数据和算法在硬件隔离区内处理，即使操作系统被攻破，数据仍受保护。

## 3 同态加密（HE）

Homomorphic Encryption。

### 3.1 定义

允许在加密数据上直接进行运算，结果解密后与明文运算一致。

### 3.2 类比理解

你把一封信锁进密码箱里，送到朋友那里，他可以在不解锁的情况下帮你算里面的内容总和，再寄回来你打开看结果。

### 3.3 实际应用

- 对新能源车的电池评分进行加密传输，接收方可以直接在这个加密数据上做评分计算，无需先解密
- 适合需要完全隐藏数据内容的场景

### 3.4 技术实现方式

使用复杂的数学结构（如 Ring-LWE、CKKS 方案），Java 中可调用 C++ 库封装接口（如 Microsoft SEAL）。

对数据进行加密后，在密文上直接运算，最后解密得到结果。HE 允许对敏感数据进行复杂计算，但性能开销大。

## 4 差分隐私（DP）

Differential Privacy。通过加入噪声保护单个记录隐私，常用于数据发布和统计分析。DP 与上述技术常结合使用，进一步降低泄露风险。

以上技术可单独或混合使用。例如如锘崴所述，隐私计算通过 MPC、HE、FL（软件层）和 TEE（硬件层）等多种路径协同工作。车联网场景中，即可在**汽车本地或边缘节点**进行模型训练和推理，而无需上传车主敏感数据，并在跨机构聚合时使用 MPC/HE 等加密技术，兼顾数据隐私与高效建模。

### 定义

在统计数据时加入随机噪声，使得输出结果对任意个体的存在与否不敏感，从而保护隐私。

### 类比理解

你问一群人平均工资，每个人回答前偷偷给自己工资加上一个随机数，这样最终的平均值还是大致准确，但没人知道谁说了实话。

### 实际应用

- 统计新能源车用户的驾驶习惯（如急刹车频率），但不希望任何人被识别出来。
- 常用于数据发布、统计分析。

### 技术实现

- 使用拉普拉斯噪声、指数机制等
- 可以集成到 SQL 查询引擎或机器学习框架中

## 5 隐匿查询（PIR）

Private Information Retrieval。

### 5.1 定义

用户可从DB查询某数据，但DB不知用户查了哪条。

### 5.2 类比理解

你在图书馆借书，但图书管理员不知道你借的哪本。

### 5.3 实际应用

- 用户想查某辆车的历史维修记录，但不想让数据中心知道是哪辆车。
- 适用于保护用户行为隐私的场景。

### 5.4 技术实现

使用加密查询协议，部分基于同态加密。

## 6 隐私求交（PSI）

Private Set Intersection。

### 定义

两个集合找出交集，但彼此不知对方的非交集元素。

### 类比理解

两个人想知道有没有共同的朋友，但不想告诉对方自己所有的朋友名单。

### 实际应用

- 两家公司想找出共同客户，但不能交换全部客户名单
- 保险公司和车企想找出哪些用户既是投保人又是车主

### 技术实现

使用Oblivious Transfer（OT）、哈希+加密等方法。

## 7 多方安全分析（MSA）

Secure Multi-Party Analysis。

### 定义

多个参与方在不共享原始数据的前提下，完成数据分析任务（如统计、回归、聚类等）。

### 类比理解

就像几个公司想统计他们员工的平均薪资，但每个公司只想贡献“汇总后的统计量”。

### 💡 实际应用：

- 多个城市想比较新能源汽车的充电频率，但不希望暴露各自城市的详细数据。
- 医疗机构之间想共享疾病分布情况，但不能泄露患者身份。

### 技术实现方式

结合 MPC、HE、DP 等多种技术。

## 8 多方安全计算（MPC）必备

Secure Multi-Party Computation，MPC，在参与方不共享各自数据且没有可信第三方的情况下安全地计算约定函数的技术和系统。

![](https://p.ipic.vip/h2aerh.png)

各方将数据加密或秘密共享，在加密状态下共同计算函数，最终只输出结果。

参与方不泄露原始数据，通过加密状态协同得到计算结果。

多方将数据加密分片，分别计算，最终合成结果，任何单方看不到完整数据。

### 类比理解

就像几个人在黑暗中同时写下一个数字，通过某种机制知道这些数加起来多少，但不知道别人写了啥。

### 应用

- 几个公司想知道他们的用户有多少是重叠的，但不想暴露各自的用户列表（隐私求交 PSI 就是它的一个子集）。
- 银行之间想统计总贷款额，但不想告诉对方自己的具体数据。

### 技术实现

设计特殊加密算法（如 Yao’s Garbled Circuits、秘密共享等）和协议，基于密码学原理实现在无可信第三方情况下，多个参与方将明文形式的数据加密后或转化后再提供给其他方，任一参与方都无法接触到其他方的明文形式的数据，从而保证各方数据的安全。

安全多方计算的基本安全算子包括同态加密、秘密分享、混淆电路、不经意传输、零知识证明、同态承诺等。

![img](https://www.primihub.com/img/anquanjisuan.4586f50f.png)

## 9 联邦学习（FL）必备

Federated Learning。

### 定义

一种分布式机器学习方法，允许多个参与方协同训练模型，但不共享原始数据。

各方本地训练模型，将加密参数汇聚更新，实现模型共享。“数据不出门，算法满地跑”。可结合安全聚合、MPC 等增强隐私。像是分布式机器学习的参数交换，避免数据直接暴露。

可让一组组织或同一组织内的群组以协作和迭代的方式，训练和改进共享的全局机器学习模型。参与方通过安全的算法协议进行联合机器学习，可以在各方数据不出本地的情况下联合多方数据源建模和提供模型推理与预测服务。

在FL框架下，各参与方只交换密文形式的中间计算结果或转化结果，不交换数据，达到数据可用不可见。

#### 联邦模型一

![](https://p.ipic.vip/4n86te.png)

#### 联邦模型二

![](https://p.ipic.vip/v3wrf4.png)

### 类比理解

像一群学生一起做题，每个人都在自己的练习本上算，最后只告诉老师答案的“趋势”，老师再统一调整教学内容。

### 实际应用

新能源车企与保险公司合作：车企提供车辆运行数据（如电池状态、行驶轨迹），保险公司提供理赔数据，双方都不交出原始数据，但可以共同训练一个更准确的风险预测模型。

### 技术实现

- 使用加密梯度聚合（如同态加密或差分隐私）
- 支持横向/纵向联邦学习

##### 横/纵向联邦学习

| 类型                          | 特点                             | 示例                                           |
| ----------------------------- | -------------------------------- | ---------------------------------------------- |
| 横向联邦学习（Horizontal FL） | 参与方拥有相同的特征，不同的样本 | 多家银行都有贷款记录，但各自有不同的客户       |
| 纵向联邦学习（Vertical FL）   | 参与方拥有相同的样本，不同的特征 | 同一家客户，银行有收入数据，保险公司有健康数据 |

## 选型建议

### 开源 V.S 商业

开源项目隐语免费且可深度定制，适合研发团队评估或基础研究。但需要投入部署运维成本。

商业平台（蚂蚁、锘崴、腾讯等）提供了更完善的产品支持和界面，适合快速落地或生产环境，但往往费用较高，且对算法改动有限制。

### 部署环境

若需要在**本地或私有云**部署，应关注系统对 Docker/Kubernetes 的支持、平台稳定性和可扩展性。隐语支持容器化部署。若更倾向**云服务**，可直接使用蚂蚁或腾讯提供的 PaaS，不必自行搭建环境。

### 自定义算法和数据控制

对于需要上传自研算法的需求，应选择支持“算法沙箱”或脚本扩展的平台。

- PrimiHub、FATE、Huakong 清交等支持用户自定义模型和协议扩展
- 商业云产品通常只提供固定算子，也可通过SDK接口进行二次开发

### 性能与安全要求

- 数据量巨大或安全级别要求极高，可考虑软硬结合方案（锘崴、清交）或专用加速卡
- 普通业务场景，纯软件方案（开源或云服务）即可满足需求

综上，根据团队技术栈和业务场景平衡可控性与易用性：

- **测试评估阶段**可选择开源平台快速搭建原型；
- **生产应用阶段**则可视实际情况选用商业平台或混合方案